"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.VideoMetadataModel = exports.VideoStatus = void 0;
var VideoStatus;
(function (VideoStatus) {
    VideoStatus["GENERATING"] = "GENERATING";
    VideoStatus["PROCESSING"] = "PROCESSING";
    VideoStatus["UPLOADING"] = "UPLOADING";
    VideoStatus["PUBLISHED"] = "PUBLISHED";
    VideoStatus["FAILED"] = "FAILED";
})(VideoStatus || (exports.VideoStatus = VideoStatus = {}));
class VideoMetadataModel {
    static create(title, description, tags, sourceTrends, s3Key) {
        const videoId = this.generateVideoId();
        const now = new Date().toISOString();
        return {
            videoId,
            uploadDate: now.split('T')[0],
            title,
            description,
            tags,
            categoryId: '22',
            privacyStatus: 'public',
            viewCount: 0,
            likeCount: 0,
            commentCount: 0,
            revenue: 0,
            sourceTrends,
            generationCost: 0,
            processingCost: 0,
            s3Key,
            status: VideoStatus.GENERATING,
            performanceMetrics: {},
            createdAt: now,
            updatedAt: now
        };
    }
    static generateVideoId() {
        return `video_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
    }
    static updateStatus(video, status) {
        return {
            ...video,
            status,
            updatedAt: new Date().toISOString()
        };
    }
    static updateYouTubeData(video, youtubeId, viewCount = 0, likeCount = 0, commentCount = 0) {
        return {
            ...video,
            youtubeId,
            viewCount,
            likeCount,
            commentCount,
            status: VideoStatus.PUBLISHED,
            updatedAt: new Date().toISOString()
        };
    }
    static updatePerformanceMetrics(video, metrics) {
        return {
            ...video,
            performanceMetrics: {
                ...video.performanceMetrics,
                ...metrics
            },
            updatedAt: new Date().toISOString()
        };
    }
    static calculateROI(video) {
        const totalCost = video.generationCost + video.processingCost;
        if (totalCost === 0)
            return 0;
        return (video.revenue - totalCost) / totalCost;
    }
    static toDynamoDbItem(video) {
        return {
            videoId: video.videoId,
            youtubeId: video.youtubeId,
            uploadDate: video.uploadDate,
            title: video.title,
            description: video.description,
            tags: video.tags,
            categoryId: video.categoryId,
            privacyStatus: video.privacyStatus,
            viewCount: video.viewCount,
            likeCount: video.likeCount,
            commentCount: video.commentCount,
            revenue: video.revenue,
            sourceTrends: video.sourceTrends,
            generationCost: video.generationCost,
            processingCost: video.processingCost,
            s3Key: video.s3Key,
            bedrockJobId: video.bedrockJobId,
            mediaConvertJobId: video.mediaConvertJobId,
            status: video.status,
            performanceMetrics: video.performanceMetrics,
            createdAt: video.createdAt,
            updatedAt: video.updatedAt
        };
    }
    static fromDynamoDbItem(item) {
        return {
            videoId: item.videoId,
            youtubeId: item.youtubeId,
            uploadDate: item.uploadDate,
            title: item.title,
            description: item.description,
            tags: item.tags || [],
            categoryId: item.categoryId,
            privacyStatus: item.privacyStatus || 'public',
            viewCount: item.viewCount || 0,
            likeCount: item.likeCount || 0,
            commentCount: item.commentCount || 0,
            revenue: item.revenue || 0,
            sourceTrends: item.sourceTrends || [],
            generationCost: item.generationCost || 0,
            processingCost: item.processingCost || 0,
            s3Key: item.s3Key,
            bedrockJobId: item.bedrockJobId,
            mediaConvertJobId: item.mediaConvertJobId,
            status: item.status || VideoStatus.GENERATING,
            performanceMetrics: item.performanceMetrics || {},
            createdAt: item.createdAt,
            updatedAt: item.updatedAt
        };
    }
}
exports.VideoMetadataModel = VideoMetadataModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlkZW8tbWV0YWRhdGEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aWRlby1tZXRhZGF0YS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUF5QkEsSUFBWSxXQU1YO0FBTkQsV0FBWSxXQUFXO0lBQ3JCLHdDQUF5QixDQUFBO0lBQ3pCLHdDQUF5QixDQUFBO0lBQ3pCLHNDQUF1QixDQUFBO0lBQ3ZCLHNDQUF1QixDQUFBO0lBQ3ZCLGdDQUFpQixDQUFBO0FBQ25CLENBQUMsRUFOVyxXQUFXLDJCQUFYLFdBQVcsUUFNdEI7QUE2QkQsTUFBYSxrQkFBa0I7SUFDN0IsTUFBTSxDQUFDLE1BQU0sQ0FDWCxLQUFhLEVBQ2IsV0FBbUIsRUFDbkIsSUFBYyxFQUNkLFlBQXNCLEVBQ3RCLEtBQWE7UUFFYixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDdkMsTUFBTSxHQUFHLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVyQyxPQUFPO1lBQ0wsT0FBTztZQUNQLFVBQVUsRUFBRSxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QixLQUFLO1lBQ0wsV0FBVztZQUNYLElBQUk7WUFDSixVQUFVLEVBQUUsSUFBSTtZQUNoQixhQUFhLEVBQUUsUUFBUTtZQUN2QixTQUFTLEVBQUUsQ0FBQztZQUNaLFNBQVMsRUFBRSxDQUFDO1lBQ1osWUFBWSxFQUFFLENBQUM7WUFDZixPQUFPLEVBQUUsQ0FBQztZQUNWLFlBQVk7WUFDWixjQUFjLEVBQUUsQ0FBQztZQUNqQixjQUFjLEVBQUUsQ0FBQztZQUNqQixLQUFLO1lBQ0wsTUFBTSxFQUFFLFdBQVcsQ0FBQyxVQUFVO1lBQzlCLGtCQUFrQixFQUFFLEVBQUU7WUFDdEIsU0FBUyxFQUFFLEdBQUc7WUFDZCxTQUFTLEVBQUUsR0FBRztTQUNmLENBQUM7SUFDSixDQUFDO0lBRU8sTUFBTSxDQUFDLGVBQWU7UUFD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LElBQUksQ0FBQyxTQUFTO1lBQ3pCLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVTtZQUMzQixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7WUFDakIsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXO1lBQzdCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxJQUFJLEVBQUU7WUFDckIsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzNCLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYSxJQUFJLFFBQVE7WUFDN0MsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQztZQUM5QixTQUFTLEVBQUUsSUFBSSxDQUFDLFNBQVMsSUFBSSxDQUFDO1lBQzlCLFlBQVksRUFBRSxJQUFJLENBQUMsWUFBWSxJQUFJLENBQUM7WUFDcEMsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQztZQUMxQixZQUFZLEVBQUUsSUFBSSxDQUFDLFlBQVksSUFBSSxFQUFFO1lBQ3JDLGNBQWMsRUFBRSxJQUFJLENBQUMsY0FBYyxJQUFJLENBQUM7WUFDeEMsY0FBYyxFQUFFLElBQUksQ0FBQyxjQUFjLElBQUksQ0FBQztZQUN4QyxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7WUFDakIsWUFBWSxFQUFFLElBQUksQ0FBQyxZQUFZO1lBQy9CLGlCQUFpQixFQUFFLElBQUksQ0FBQyxpQkFBaUI7WUFDekMsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLElBQUksV0FBVyxDQUFDLFVBQVU7WUFDN0Msa0JBQWtCLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixJQUFJLEVBQUU7WUFDakQsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1lBQ3pCLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUztTQUMxQixDQUFDO0lBQ0osQ0FBQztDQUNGO0FBeklELGdEQXlJQyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgVmlkZW9NZXRhZGF0YSB7XHJcbiAgdmlkZW9JZDogc3RyaW5nO1xyXG4gIHlvdXR1YmVJZD86IHN0cmluZztcclxuICB1cGxvYWREYXRlOiBzdHJpbmc7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHRhZ3M6IHN0cmluZ1tdO1xyXG4gIGNhdGVnb3J5SWQ6IHN0cmluZztcclxuICBwcml2YWN5U3RhdHVzOiBzdHJpbmc7XHJcbiAgdmlld0NvdW50OiBudW1iZXI7XHJcbiAgbGlrZUNvdW50OiBudW1iZXI7XHJcbiAgY29tbWVudENvdW50OiBudW1iZXI7XHJcbiAgcmV2ZW51ZTogbnVtYmVyO1xyXG4gIHNvdXJjZVRyZW5kczogc3RyaW5nW107XHJcbiAgZ2VuZXJhdGlvbkNvc3Q6IG51bWJlcjtcclxuICBwcm9jZXNzaW5nQ29zdDogbnVtYmVyO1xyXG4gIHMzS2V5OiBzdHJpbmc7XHJcbiAgYmVkcm9ja0pvYklkPzogc3RyaW5nO1xyXG4gIG1lZGlhQ29udmVydEpvYklkPzogc3RyaW5nO1xyXG4gIHN0YXR1czogVmlkZW9TdGF0dXM7XHJcbiAgcGVyZm9ybWFuY2VNZXRyaWNzOiBQZXJmb3JtYW5jZU1ldHJpY3M7XHJcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XHJcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFZpZGVvU3RhdHVzIHtcclxuICBHRU5FUkFUSU5HID0gJ0dFTkVSQVRJTkcnLFxyXG4gIFBST0NFU1NJTkcgPSAnUFJPQ0VTU0lORycsXHJcbiAgVVBMT0FESU5HID0gJ1VQTE9BRElORycsXHJcbiAgUFVCTElTSEVEID0gJ1BVQkxJU0hFRCcsXHJcbiAgRkFJTEVEID0gJ0ZBSUxFRCdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBQZXJmb3JtYW5jZU1ldHJpY3Mge1xyXG4gIGltcHJlc3Npb25zPzogbnVtYmVyO1xyXG4gIGNsaWNrVGhyb3VnaFJhdGU/OiBudW1iZXI7XHJcbiAgYXZlcmFnZVZpZXdEdXJhdGlvbj86IG51bWJlcjtcclxuICBzdWJzY3JpYmVyc0dhaW5lZD86IG51bWJlcjtcclxuICBlc3RpbWF0ZWRSZXZlbnVlPzogbnVtYmVyO1xyXG4gIGVuZ2FnZW1lbnRSYXRlPzogbnVtYmVyO1xyXG4gIHJldGVudGlvblJhdGU/OiBudW1iZXI7XHJcbiAgdHJhZmZpY1NvdXJjZXM/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xyXG4gIGRlbW9ncmFwaGljcz86IHtcclxuICAgIGFnZUdyb3Vwcz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgICBnZW5kZXJzPzogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcclxuICAgIGNvdW50cmllcz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBWaWRlb0dlbmVyYXRpb25SZXF1ZXN0IHtcclxuICBzY3JpcHRDb250ZW50OiBzdHJpbmc7XHJcbiAgdGFyZ2V0S2V5d29yZHM6IHN0cmluZ1tdO1xyXG4gIHNvdXJjZVRyZW5kczogc3RyaW5nW107XHJcbiAgdmlkZW9Db25maWc6IHtcclxuICAgIGR1cmF0aW9uOiBudW1iZXI7XHJcbiAgICBxdWFsaXR5OiBzdHJpbmc7XHJcbiAgICBmb3JtYXQ6IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmlkZW9NZXRhZGF0YU1vZGVsIHtcclxuICBzdGF0aWMgY3JlYXRlKFxyXG4gICAgdGl0bGU6IHN0cmluZyxcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICB0YWdzOiBzdHJpbmdbXSxcclxuICAgIHNvdXJjZVRyZW5kczogc3RyaW5nW10sXHJcbiAgICBzM0tleTogc3RyaW5nXHJcbiAgKTogVmlkZW9NZXRhZGF0YSB7XHJcbiAgICBjb25zdCB2aWRlb0lkID0gdGhpcy5nZW5lcmF0ZVZpZGVvSWQoKTtcclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdmlkZW9JZCxcclxuICAgICAgdXBsb2FkRGF0ZTogbm93LnNwbGl0KCdUJylbMF0sIC8vIFlZWVktTU0tREQgZm9ybWF0IGZvciBHU0lcclxuICAgICAgdGl0bGUsXHJcbiAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgICB0YWdzLFxyXG4gICAgICBjYXRlZ29yeUlkOiAnMjInLCAvLyBQZW9wbGUgJiBCbG9ncyAtIGNhbiBiZSBtYWRlIGNvbmZpZ3VyYWJsZVxyXG4gICAgICBwcml2YWN5U3RhdHVzOiAncHVibGljJyxcclxuICAgICAgdmlld0NvdW50OiAwLFxyXG4gICAgICBsaWtlQ291bnQ6IDAsXHJcbiAgICAgIGNvbW1lbnRDb3VudDogMCxcclxuICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgc291cmNlVHJlbmRzLFxyXG4gICAgICBnZW5lcmF0aW9uQ29zdDogMCxcclxuICAgICAgcHJvY2Vzc2luZ0Nvc3Q6IDAsXHJcbiAgICAgIHMzS2V5LFxyXG4gICAgICBzdGF0dXM6IFZpZGVvU3RhdHVzLkdFTkVSQVRJTkcsXHJcbiAgICAgIHBlcmZvcm1hbmNlTWV0cmljczoge30sXHJcbiAgICAgIGNyZWF0ZWRBdDogbm93LFxyXG4gICAgICB1cGRhdGVkQXQ6IG5vd1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlVmlkZW9JZCgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGB2aWRlb18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgdXBkYXRlU3RhdHVzKHZpZGVvOiBWaWRlb01ldGFkYXRhLCBzdGF0dXM6IFZpZGVvU3RhdHVzKTogVmlkZW9NZXRhZGF0YSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi52aWRlbyxcclxuICAgICAgc3RhdHVzLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyB1cGRhdGVZb3VUdWJlRGF0YShcclxuICAgIHZpZGVvOiBWaWRlb01ldGFkYXRhLFxyXG4gICAgeW91dHViZUlkOiBzdHJpbmcsXHJcbiAgICB2aWV3Q291bnQ6IG51bWJlciA9IDAsXHJcbiAgICBsaWtlQ291bnQ6IG51bWJlciA9IDAsXHJcbiAgICBjb21tZW50Q291bnQ6IG51bWJlciA9IDBcclxuICApOiBWaWRlb01ldGFkYXRhIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLnZpZGVvLFxyXG4gICAgICB5b3V0dWJlSWQsXHJcbiAgICAgIHZpZXdDb3VudCxcclxuICAgICAgbGlrZUNvdW50LFxyXG4gICAgICBjb21tZW50Q291bnQsXHJcbiAgICAgIHN0YXR1czogVmlkZW9TdGF0dXMuUFVCTElTSEVELFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyB1cGRhdGVQZXJmb3JtYW5jZU1ldHJpY3MoXHJcbiAgICB2aWRlbzogVmlkZW9NZXRhZGF0YSxcclxuICAgIG1ldHJpY3M6IFBhcnRpYWw8UGVyZm9ybWFuY2VNZXRyaWNzPlxyXG4gICk6IFZpZGVvTWV0YWRhdGEge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgLi4udmlkZW8sXHJcbiAgICAgIHBlcmZvcm1hbmNlTWV0cmljczoge1xyXG4gICAgICAgIC4uLnZpZGVvLnBlcmZvcm1hbmNlTWV0cmljcyxcclxuICAgICAgICAuLi5tZXRyaWNzXHJcbiAgICAgIH0sXHJcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGNhbGN1bGF0ZVJPSSh2aWRlbzogVmlkZW9NZXRhZGF0YSk6IG51bWJlciB7XHJcbiAgICBjb25zdCB0b3RhbENvc3QgPSB2aWRlby5nZW5lcmF0aW9uQ29zdCArIHZpZGVvLnByb2Nlc3NpbmdDb3N0O1xyXG4gICAgaWYgKHRvdGFsQ29zdCA9PT0gMCkgcmV0dXJuIDA7XHJcbiAgICByZXR1cm4gKHZpZGVvLnJldmVudWUgLSB0b3RhbENvc3QpIC8gdG90YWxDb3N0O1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHRvRHluYW1vRGJJdGVtKHZpZGVvOiBWaWRlb01ldGFkYXRhKTogUmVjb3JkPHN0cmluZywgYW55PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB2aWRlb0lkOiB2aWRlby52aWRlb0lkLFxyXG4gICAgICB5b3V0dWJlSWQ6IHZpZGVvLnlvdXR1YmVJZCxcclxuICAgICAgdXBsb2FkRGF0ZTogdmlkZW8udXBsb2FkRGF0ZSxcclxuICAgICAgdGl0bGU6IHZpZGVvLnRpdGxlLFxyXG4gICAgICBkZXNjcmlwdGlvbjogdmlkZW8uZGVzY3JpcHRpb24sXHJcbiAgICAgIHRhZ3M6IHZpZGVvLnRhZ3MsXHJcbiAgICAgIGNhdGVnb3J5SWQ6IHZpZGVvLmNhdGVnb3J5SWQsXHJcbiAgICAgIHByaXZhY3lTdGF0dXM6IHZpZGVvLnByaXZhY3lTdGF0dXMsXHJcbiAgICAgIHZpZXdDb3VudDogdmlkZW8udmlld0NvdW50LFxyXG4gICAgICBsaWtlQ291bnQ6IHZpZGVvLmxpa2VDb3VudCxcclxuICAgICAgY29tbWVudENvdW50OiB2aWRlby5jb21tZW50Q291bnQsXHJcbiAgICAgIHJldmVudWU6IHZpZGVvLnJldmVudWUsXHJcbiAgICAgIHNvdXJjZVRyZW5kczogdmlkZW8uc291cmNlVHJlbmRzLFxyXG4gICAgICBnZW5lcmF0aW9uQ29zdDogdmlkZW8uZ2VuZXJhdGlvbkNvc3QsXHJcbiAgICAgIHByb2Nlc3NpbmdDb3N0OiB2aWRlby5wcm9jZXNzaW5nQ29zdCxcclxuICAgICAgczNLZXk6IHZpZGVvLnMzS2V5LFxyXG4gICAgICBiZWRyb2NrSm9iSWQ6IHZpZGVvLmJlZHJvY2tKb2JJZCxcclxuICAgICAgbWVkaWFDb252ZXJ0Sm9iSWQ6IHZpZGVvLm1lZGlhQ29udmVydEpvYklkLFxyXG4gICAgICBzdGF0dXM6IHZpZGVvLnN0YXR1cyxcclxuICAgICAgcGVyZm9ybWFuY2VNZXRyaWNzOiB2aWRlby5wZXJmb3JtYW5jZU1ldHJpY3MsXHJcbiAgICAgIGNyZWF0ZWRBdDogdmlkZW8uY3JlYXRlZEF0LFxyXG4gICAgICB1cGRhdGVkQXQ6IHZpZGVvLnVwZGF0ZWRBdFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBmcm9tRHluYW1vRGJJdGVtKGl0ZW06IFJlY29yZDxzdHJpbmcsIGFueT4pOiBWaWRlb01ldGFkYXRhIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHZpZGVvSWQ6IGl0ZW0udmlkZW9JZCxcclxuICAgICAgeW91dHViZUlkOiBpdGVtLnlvdXR1YmVJZCxcclxuICAgICAgdXBsb2FkRGF0ZTogaXRlbS51cGxvYWREYXRlLFxyXG4gICAgICB0aXRsZTogaXRlbS50aXRsZSxcclxuICAgICAgZGVzY3JpcHRpb246IGl0ZW0uZGVzY3JpcHRpb24sXHJcbiAgICAgIHRhZ3M6IGl0ZW0udGFncyB8fCBbXSxcclxuICAgICAgY2F0ZWdvcnlJZDogaXRlbS5jYXRlZ29yeUlkLFxyXG4gICAgICBwcml2YWN5U3RhdHVzOiBpdGVtLnByaXZhY3lTdGF0dXMgfHwgJ3B1YmxpYycsXHJcbiAgICAgIHZpZXdDb3VudDogaXRlbS52aWV3Q291bnQgfHwgMCxcclxuICAgICAgbGlrZUNvdW50OiBpdGVtLmxpa2VDb3VudCB8fCAwLFxyXG4gICAgICBjb21tZW50Q291bnQ6IGl0ZW0uY29tbWVudENvdW50IHx8IDAsXHJcbiAgICAgIHJldmVudWU6IGl0ZW0ucmV2ZW51ZSB8fCAwLFxyXG4gICAgICBzb3VyY2VUcmVuZHM6IGl0ZW0uc291cmNlVHJlbmRzIHx8IFtdLFxyXG4gICAgICBnZW5lcmF0aW9uQ29zdDogaXRlbS5nZW5lcmF0aW9uQ29zdCB8fCAwLFxyXG4gICAgICBwcm9jZXNzaW5nQ29zdDogaXRlbS5wcm9jZXNzaW5nQ29zdCB8fCAwLFxyXG4gICAgICBzM0tleTogaXRlbS5zM0tleSxcclxuICAgICAgYmVkcm9ja0pvYklkOiBpdGVtLmJlZHJvY2tKb2JJZCxcclxuICAgICAgbWVkaWFDb252ZXJ0Sm9iSWQ6IGl0ZW0ubWVkaWFDb252ZXJ0Sm9iSWQsXHJcbiAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMgfHwgVmlkZW9TdGF0dXMuR0VORVJBVElORyxcclxuICAgICAgcGVyZm9ybWFuY2VNZXRyaWNzOiBpdGVtLnBlcmZvcm1hbmNlTWV0cmljcyB8fCB7fSxcclxuICAgICAgY3JlYXRlZEF0OiBpdGVtLmNyZWF0ZWRBdCxcclxuICAgICAgdXBkYXRlZEF0OiBpdGVtLnVwZGF0ZWRBdFxyXG4gICAgfTtcclxuICB9XHJcbn0iXX0=